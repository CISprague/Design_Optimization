<?xml version="1.0" encoding="iso-8859-1" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>SHAPE OPTIMISATION OF HEAT EXCHANGER</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<!-- xhtml,html --> 
<meta name="src" content="TemplateICATT.tex" /> 
<link rel="stylesheet" type="text/css" href="TemplateICATT.css" /> 
</head><body 
>
   <div class="maketitle">


<h2 class="titleHead">SHAPE OPTIMISATION OF HEAT EXCHANGER</h2>
<span 
class="ptmri7t-x-x-120">Christopher Iliffe Sprague</span><br /><br /><br />
   </div>
   <div 
class="abstract" 
>
<div class="center" 
>
<!--l. 47--><p class="noindent" >
</p><!--l. 47--><p class="noindent" ><span 
class="ptmb7t-">ABSTRACT</span></p></div>
<!--l. 48--><p class="noindent" >This paper examines the design optimization of a repeating
two-dimensional heat exchanger section. Focus is particularly
directed upon a heat exchanger section with a variable top surface
shape, and straight bottom, left, and right sides. The heat
exchanger&#8217;s top surface is parametrized by a mathematical
model, subject to section continuity and vertical thickness
constraints. Its geometry is discretized into a mesh from
which the heat flux per unit length is computed through
finite-volume methods. Different optimization algorithms and
mesh resolutions are examined in regard to their performance in
maximizing the heat exchanger&#8217;s flux per unit length. It is
shown that through the optimization of different mathematical
characterizations of the heat exchanger&#8217;s top surface that, in fact, a
heat flux per unit length greater than 35% of the nominal value
from a flat top surface is possible, while abiding to thickness
constraints.
</p>
   </div>
   <h3 class="likesectionHead"><a 
 id="x1-1000"></a>Contents</h3>
   <div class="tableofcontents">
   <span class="sectionToc" >1 <a 
href="#x1-50001" id="QQ2-1-5">Method</a></span>
<br />   &#x00A0;<span class="subsectionToc" >1.1 <a 
href="#x1-60001.1" id="QQ2-1-6">Finite Volume</a></span>
<br />   &#x00A0;<span class="subsectionToc" >1.2 <a 
href="#x1-70001.2" id="QQ2-1-7">Green-Gauss Theorem</a></span>
<br />   <span class="sectionToc" >2 <a 
href="#x1-80002" id="QQ2-1-8">Parametrization</a></span>
<br />   &#x00A0;<span class="subsectionToc" >2.1 <a 
href="#x1-90002.1" id="QQ2-1-9">Top Surface Geometry</a></span>
<br />   &#x00A0;<span class="subsectionToc" >2.2 <a 
href="#x1-100002.2" id="QQ2-1-10">Problem Requirements</a></span>
<br />   <span class="sectionToc" >3 <a 
href="#x1-110003" id="QQ2-1-11">Optimization</a></span>
<br />   &#x00A0;<span class="subsectionToc" >3.1 <a 
href="#x1-120003.1" id="QQ2-1-12">Problem Formulation</a></span>
<br />   &#x00A0;<span class="subsectionToc" >3.2 <a 
href="#x1-130003.2" id="QQ2-1-13">Solvers</a></span>
<br />   <span class="sectionToc" >4 <a 
href="#x1-140004" id="QQ2-1-14">Implementation</a></span>
<br />   &#x00A0;<span class="subsectionToc" >4.1 <a 
href="#x1-150004.1" id="QQ2-1-16">Dynamic Coefficient Creation</a></span>
<br />   &#x00A0;<span class="subsectionToc" >4.2 <a 
href="#x1-160004.2" id="QQ2-1-19">Work Flow</a></span>                                   <br />      <span class="sectionToc" >5 <a 
href="#x1-170005" id="QQ2-1-20">Results</a></span>
                                                  <br />      &#x00A0;<span class="subsectionToc" >5.1 <a 
href="#x1-180005.1" id="QQ2-1-21">Initial Findings</a></span>
                                                  <br />      &#x00A0;<span class="subsectionToc" >5.2 <a 
href="#x1-190005.2" id="QQ2-1-22">Interior-Point Optimizer</a></span>
                                                  <br />      &#x00A0;<span class="subsectionToc" >5.3 <a 
href="#x1-200005.3" id="QQ2-1-27">Sequential Quadratic Programming</a></span>
                                                  <br />      <span class="sectionToc" >6 <a 
href="#x1-210006" id="QQ2-1-29">Conclusions</a></span>
                                                  <br />      <span class="sectionToc" >7 <a 
href="#x1-220007" id="QQ2-1-30">Tables</a></span>
                                                  <br />      <span class="sectionToc" >8 <a 
href="#x1-230008" id="QQ2-1-32">Source Code</a></span>
                                                     </div>
                                                     <h3 class="likesectionHead"><a 
 id="x1-2000"></a>List of Tables</h3>
                                                     <div class="tableofcontents"><span class="lotToc" >1&#x00A0;<a 
href="#x1-22001r1">Interior Point Optimizer Performance</a></span><br />
                                                     </div>
                                                     <h3 class="likesectionHead"><a 
 id="x1-3000"></a>List of Figures</h3>
                                                     <div class="tableofcontents"><span class="lofToc" >1&#x00A0;<a 
href="#x1-15011r1">Dynamic Coefficient Creation</a></span><br /><span class="lofToc" >2&#x00A0;<a 
href="#x1-19011r2">IPOPT with 6 coefficients and 100 node
                                                  resolution</a></span><br /><span class="lofToc" >3&#x00A0;<a 
href="#x1-19012r3">IPOPT with 6 coefficients and 200 node resolution</a></span><br /><span class="lofToc" >4&#x00A0;<a 
href="#x1-19013r4">IPOPT with 5
                                                  coefficients and 200 node resolution</a></span><br /><span class="lofToc" >5&#x00A0;<a 
href="#x1-20001r5">SQP with 6 coefficients and 200 node resolution</a></span><br />
                                                     </div>
                                                     <h3 class="likesectionHead"><a 
 id="x1-4000"></a>Listings</h3>
                                                     <div class="tableofcontents">
                                                     <span class="sectionToc" >1 <a 
href="#x1-50001">Method</a></span>
                                                  <br />      &#x00A0;<span class="subsectionToc" >1.1 <a 
href="#x1-60001.1">Finite Volume</a></span>
                                                  <br />      &#x00A0;<span class="subsectionToc" >1.2 <a 
href="#x1-70001.2">Green-Gauss Theorem</a></span>
                                                  <br />      <span class="sectionToc" >2 <a 
href="#x1-80002">Parametrization</a></span>
                                                  <br />      &#x00A0;<span class="subsectionToc" >2.1 <a 
href="#x1-90002.1">Top Surface Geometry</a></span>
                                                  <br />      &#x00A0;<span class="subsectionToc" >2.2 <a 
href="#x1-100002.2">Problem Requirements</a></span>
                                                  <br />      <span class="sectionToc" >3 <a 
href="#x1-110003">Optimization</a></span>
                                                  <br />      &#x00A0;<span class="subsectionToc" >3.1 <a 
href="#x1-120003.1">Problem Formulation</a></span>
                                                  <br />      &#x00A0;<span class="subsectionToc" >3.2 <a 
href="#x1-130003.2">Solvers</a></span>
                                                  <br />      <span class="sectionToc" >4 <a 
href="#x1-140004">Implementation</a></span>
                                                  <br />      &#x00A0;<span class="subsectionToc" >4.1 <a 
href="#x1-150004.1">Dynamic Coefficient Creation</a></span>
                                                  <br />      &#x00A0;<span class="subsectionToc" >4.2 <a 
href="#x1-160004.2">Work Flow</a></span>

<br />   <span class="sectionToc" >5 <a 
href="#x1-170005">Results</a></span>
<br />   &#x00A0;<span class="subsectionToc" >5.1 <a 
href="#x1-180005.1">Initial Findings</a></span>
<br />   &#x00A0;<span class="subsectionToc" >5.2 <a 
href="#x1-190005.2">Interior-Point Optimizer</a></span>
<br />   &#x00A0;<span class="subsectionToc" >5.3 <a 
href="#x1-200005.3">Sequential Quadratic Programming</a></span>
<br />   <span class="sectionToc" >6 <a 
href="#x1-210006">Conclusions</a></span>
<br />   <span class="sectionToc" >7 <a 
href="#x1-220007">Tables</a></span>
<br />   <span class="sectionToc" >8 <a 
href="#x1-230008">Source Code</a></span>
   </div>
<!--l. 56--><p class="noindent" ><span 
class="ptmb7t-">1.</span>
</p>
   <h3 class="sectionHead"><span class="titlemark">1    </span> <a 
 id="x1-50001"></a>Method</h3>
<!--l. 57--><p class="noindent" >In the context of a two dimensional heat exchanger without heat
generation, convention leads to the use of the partial differential
equation in Cartesian coordinates:
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-5001r1"></a>
   <center class="math-display" >
<img 
src="TemplateICATT0x.png" alt="&#x2202;2T   &#x2202;2T
&#x2202;x2-+ &#x2202;y2-= 0
" class="math-display"  /></center></td><td class="equation-label">(1)</td></tr></table>
<!--l. 61--><p class="nopar" >
Through Fourier&#8217;s law, the heat flux associated with the
heat exchanger&#8217;s temperature profile, <span 
class="cmmi-10">T</span><span 
class="cmr-10">(</span><span 
class="cmmi-10">x,y</span><span 
class="cmr-10">)</span>, and thermal
conductivity, <span 
class="cmmi-10">k</span>, becomes:
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-5002r2"></a>
   <center class="math-display" >
<img 
src="TemplateICATT1x.png" alt="q = - k&#x2207;T
" class="math-display"  /></center></td><td class="equation-label">(2)</td></tr></table>
<!--l. 65--><p class="nopar" >
However, when examining a heat exchanger optimization problem
with a rather irregular geometrical structure, it is significantly
more convenient to use methods which allow for unstructured
meshes. One of such methods is the finite volume method,     which essentially allows one to represent and evaluate partial
                                                  differential equations, such as Equation <a 
href="#x1-5001r1">1<!--tex4ht:ref: eq:heat --></a>, in the form of algebraic
                                                  equations.
                                                  </p><!--l. 68--><p class="noindent" ><span 
class="ptmb7t-">1.1.</span>
                                                  </p>
                                                     <h4 class="subsectionHead"><span class="titlemark">1.1    </span> <a 
 id="x1-60001.1"></a>Finite Volume</h4>
                                                  <!--l. 69--><p class="noindent" >Through the finite volume method, values must be calculated at
                                                  discrete places, otherwise known as nodes, within a meshed
                                                  geometry <span class="cite">[<span 
class="ptmb7t-">?</span>]</span>. Sub-dividing the heat exchanger&#8217;s spatial domain
                                                  into finite volumes (i.e. cells), for a particular cell, <span 
class="cmmi-10">i</span>, the volume
                                                  integral can be taken over the total volume of the cell, <span 
class="cmmi-10">v</span><sub><span 
class="cmmi-7">i</span></sub>. This
                                                  results in the problem&#8217;s partial differential equation transforming
                                                  as follows:
                                                  </p>
                                                     <table 
class="equation"><tr><td><a 
 id="x1-6001r3"></a>
                                                     <center class="math-display" >
                                                  <img 
src="TemplateICATT2x.png" alt="             1 &#x222E;
&#x2207; &#x22C5;f(u ) = 0 &#x21D2; v   f(u)&#x22C5;ndS = 0
              i si
                                                  " class="math-display"  /></center></td><td class="equation-label">(3)</td></tr></table>
                                                  <!--l. 72--><p class="nopar" >
                                                  where <span 
class="cmbx-10">u </span>represents a vector of states, <span 
class="cmbx-10">f </span>represents the flux tensor,
                                                  <span 
class="cmmi-10">s</span><sub><span 
class="cmmi-7">i</span></sub> represents the total surface area of the cell, and <span 
class="cmbx-10">n </span>represents
                                                  the unit vector normal to the surface of the cell pointing
                                                  outward.
                                                  </p><!--l. 75--><p class="noindent" ><span 
class="ptmb7t-">1.2.</span>
                                                  </p>
                                                     <h4 class="subsectionHead"><span class="titlemark">1.2    </span> <a 
 id="x1-70001.2"></a>Green-Gauss Theorem</h4>
                                                  <!--l. 76--><p class="noindent" >In the case of generally unstructured grid meshes, it is no longer
                                                  feasible to compute the gradient of a scalar at a given volume
                                                  centroid using the definition of derivatives. Rather, it is convenient
                                                  to implement the conventional Green-Gauss theorem <span class="cite">[<span 
class="ptmb7t-">?</span>]</span>. This
                                                  theorem states that the surface integral of a scalar function is equal
                                                  to the volume integral of the gradient of the scalar function; in
                                                  mathematical representation:
                                                  </p>
                                                     <table 
class="equation"><tr><td><a 
 id="x1-7001r4"></a>

   <center class="math-display" >
<img 
src="TemplateICATT3x.png" alt="&#x222B;          &#x222B;
   &#x2207; &#x03D5;dV =   &#x03D5;ndS
 V          S
" class="math-display"  /></center></td><td class="equation-label">(4)</td></tr></table>
<!--l. 79--><p class="nopar" >
where <span 
class="cmbx-10">n </span>is the surface normal pointing out from the volume, <span 
class="cmmi-10">&#x03D5; </span>is a
scalar, <span 
class="cmmi-10">S </span>is the surface, and <span 
class="cmmi-10">V </span>is the volume. After assuming the
gradient of the scalar, <span 
class="cmsy-10">&#x2207;</span><span 
class="cmmi-10">&#x03D5;</span>, is constant over the control volume and
that the integral over the surface can be represented as a
summation of the average scalar value in each face multiplied by
the face&#8217;s surface vector, the theorem can be reformulated as
follows:
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-7002r5"></a>
   <center class="math-display" >
<img 
src="TemplateICATT4x.png" alt="      1&#x2211;N
&#x2207;&#x03D5; = --    &#x03D5;iSi
     V  i=1
" class="math-display"  /></center></td><td class="equation-label">(5)</td></tr></table>
<!--l. 83--><p class="nopar" >
Using this methodology, the horizontal derivatives are used
to correct the fluxes along the heat exchanger&#8217;s faces, that
have both horizontal and vertical components to the face
normal. After applying Dirichlet boundary conditions to
both the top and bottom surfaces of the heat exchanger&#8217;s
geometry and applying the Green-Gauss discretization to
the geometry&#8217;s mesh, the heat flux per unit length can be
computed.
</p><!--l. 86--><p class="noindent" ><span 
class="ptmb7t-">2.</span>
</p>
   <h3 class="sectionHead"><span class="titlemark">2    </span> <a 
 id="x1-80002"></a>Parametrization</h3>
<!--l. 87--><p class="noindent" ><span 
class="ptmb7t-">2.1.</span>
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.1    </span> <a 
 id="x1-90002.1"></a>Top Surface Geometry</h4>                         <!--l. 88--><p class="noindent" >In the effort to optimize the shape of the heat exchanger&#8217;s top
                                                  surface, it is fitting to apply some sort of mathematical model.
                                                  Given that this particular problem requires that the shape&#8217;s
                                                  boundary conditions on both the left and right sides be periodic to
                                                  allow continual section addition, it is convenient to select a
                                                  mathematical model that is innately periodic, namely a sin series.
                                                  The general form of a sin series representing the heat exchanger&#8217;s
                                                  vertical thickness as a function of horizontal distance, <span 
class="cmmi-10">h</span><span 
class="cmr-10">(</span><span 
class="cmmi-10">x</span><span 
class="cmr-10">)</span>, can
                                                  be shown as follows:
                                                  </p>
                                                     <table 
class="equation"><tr><td><a 
 id="x1-9001r6"></a>
                                                     <center class="math-display" >
                                                  <img 
src="TemplateICATT5x.png" alt="             &#x2211;N      ( 2&#x03C0;(n - 1)x)
h (a,x) = a1 +   ansin  ---Lx-----
             n=2
                                                  " class="math-display"  /></center></td><td class="equation-label">(6)</td></tr></table>
                                                  <!--l. 92--><p class="nopar" >
                                                  </p><!--l. 94--><p class="indent" >   where <span 
class="cmr-10">[</span><span 
class="cmmi-10">a</span><sub><span 
class="cmr-7">1</span></sub><span 
class="cmmi-10">,</span><span 
class="cmmi-10">&#x2026;</span><span 
class="cmmi-10">,a</span><sub><span 
class="cmmi-7">n</span></sub><span 
class="cmr-10">]</span><sup><span 
class="cmmi-7">T</span></sup> represents the coefficient vector, <span 
class="cmmi-10">N </span>represents
                                                  the number of coefficients, and <span 
class="cmmi-10">L</span><sub><span 
class="cmmi-7">x</span></sub> is the horizontal width of the
                                                  heat exchanger as a whole. In the programming language of
                                                  MATLAB, this formulation culminates in the form of the class
                                                  instance function shown in <span class="lstinline"></span><span 
class="pcrb7t-x-x-80">function</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">ts</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">=</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">Surface</span><span 
class="pcrr7t-x-x-80">(</span><span 
class="pcrr7t-x-x-80">obj</span><span 
class="pcrr7t-x-x-80">,</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">a</span><span 
class="pcrr7t-x-x-80">)</span>
                                                  of Listing <a 
href="#x1-23001r4">4<!--tex4ht:ref: Heat_Exchanger --></a>, that generates a discretized mesh of the heat
                                                  exchanger&#8217;s top surface in accordance to variable size vector of
                                                  coefficients.
                                                  </p><!--l. 96--><p class="noindent" ><span 
class="ptmb7t-">2.2.</span>
                                                  </p>
                                                     <h4 class="subsectionHead"><span class="titlemark">2.2    </span> <a 
 id="x1-100002.2"></a>Problem Requirements</h4>
                                                  <!--l. 97--><p class="noindent" >As required by the given problem, the heat exchanger is asserted
                                                  to have several constant preexisting properties, namely: a
                                                  horizontal width, <span 
class="cmmi-10">L</span><sub><span 
class="cmmi-7">x</span></sub>, of <span 
class="cmr-10">5</span><span 
class="cmmi-10">&#x00A0;cm</span>, a thermal conductivity, <span 
class="cmmi-10">&#x03BA;</span>, of
                                                  <span 
class="cmr-10">20</span><span 
class="cmmi-10">&#x00A0;</span><img 
src="TemplateICATT6x.png" alt="W&#x2218;&#x22C5;mK-"  class="frac" align="middle" />, and a minimum and maximum vertical thickness, <span 
class="cmmi-10">h</span><span 
class="cmr-10">(</span><span 
class="cmmi-10">x</span><span 
class="cmr-10">)</span>,
                                                  of <span 
class="cmr-10">1</span><span 
class="cmmi-10">&#x00A0;cm </span>and <span 
class="cmr-10">5</span><span 
class="cmmi-10">&#x00A0;cm </span>respectively. Beyond intrinsic parameters, the
                                                  environment is modelled to assert a bottom and top temperature of
                                                  <span 
class="cmmi-10">T</span><sub><span 
class="cmr-7">1</span></sub> <span 
class="cmr-10">= 90</span><sup><span 
class="cmsy-7">&#x2218;</span></sup><span 
class="cmmi-10">K </span>and <span 
class="cmmi-10">T</span><sub><span 
class="cmr-7">2</span></sub> <span 
class="cmr-10">= 20</span><sup><span 
class="cmsy-7">&#x2218;</span></sup><span 
class="cmmi-10">K </span>respectively. This environmental
                                                  model closely represents the application of a radiator, in which it
                                                  is desired to transfer heat from hot water, designated by <span 
class="cmmi-10">T</span><sub><span 
class="cmr-7">1</span></sub>, to air,
                                                  designated by <span 
class="cmmi-10">T</span><sub><span 
class="cmr-7">2</span></sub>.
                                                  </p><!--l. 99--><p class="noindent" ><span 
class="ptmb7t-">3.</span>
                                                  </p>
                                                     <h3 class="sectionHead"><span class="titlemark">3    </span> <a 
 id="x1-110003"></a>Optimization</h3>

<!--l. 100--><p class="noindent" ><span 
class="ptmb7t-">3.1.</span>
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.1    </span> <a 
 id="x1-120003.1"></a>Problem Formulation</h4>
<!--l. 101--><p class="noindent" >Essentially, the goal of this study is to maximize the heat
exchanger&#8217;s flux per unit length through alteration of its top
surface shape, while abiding to constraints. In the conventional
generalization of optimization problems, one has an objective
function to be minimized, subject to inequality constraints,
equality constraints, and domain bound constraints. In the case of
the heat exchanger, this problem boils down to the following
formulation:
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-12001r7"></a>
   <center class="math-display" >
<img 
src="TemplateICATT7x.png" alt="m inimize  Flux(a)
   a
subjectto 1 cm &#x2264; h(a,x) &#x2264; 5cm
" class="math-display"  /></center></td><td class="equation-label">(7)</td></tr></table>
<!--l. 109--><p class="nopar" >
where <span 
class="cmr-10">Flux</span><span 
class="cmr-10">(</span><span 
class="cmbx-10">a</span><span 
class="cmr-10">) </span>represents the flux per unit length as a function
top surface geometry determined by the coefficient vector,
<span 
class="cmbx-10">a </span><span 
class="cmr-10">= </span><img 
src="TemplateICATT8x.png" alt="[a1,...,aN]"  class="left" align="middle" /><sup><span 
class="cmmi-7">T</span></sup>, and the thickness at any point along the
top surface, <span 
class="cmmi-10">h</span><span 
class="cmr-10">(</span><span 
class="cmbx-10">a</span><span 
class="cmmi-10">,x</span><span 
class="cmr-10">) </span>is within constraints. The MATLAB
implementation of this formulation is shown in the objective
function, <span class="lstinline"></span><span 
class="pcrb7t-x-x-80">function</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">f</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">=</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">Neg_Flux</span><span 
class="pcrr7t-x-x-80">(</span><span 
class="pcrr7t-x-x-80">obj</span><span 
class="pcrr7t-x-x-80">,</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">a</span><span 
class="pcrr7t-x-x-80">)</span>, and the constraint
function, <span class="lstinline"></span><span 
class="pcrb7t-x-x-80">function</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">[</span><span 
class="pcrr7t-x-x-80">c</span><span 
class="pcrr7t-x-x-80">,</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">ceq</span><span 
class="pcrr7t-x-x-80">]</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">=</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">Thickness_Limit</span><span 
class="pcrr7t-x-x-80">(</span><span 
class="pcrr7t-x-x-80">obj</span><span 
class="pcrr7t-x-x-80">,</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">a</span><span 
class="pcrr7t-x-x-80">)</span> of
Listing <a 
href="#x1-23001r4">4<!--tex4ht:ref: Heat_Exchanger --></a>.
</p><!--l. 112--><p class="noindent" ><span 
class="ptmb7t-">3.2.</span>
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.2    </span> <a 
 id="x1-130003.2"></a>Solvers</h4>
<!--l. 113--><p class="noindent" >In this paper MATLAB&#8217;s <span class="lstinline"></span><span 
class="pcrr7t-x-x-80">fmincon</span> is used to assess the effectiveness
of different optimization algorithms, namely: interior point
method, active set method, and sequential quadratic programming.
The interior point method is capable handling large, sparse
problems, as well as small dense problems, and is able to satisfy
bounds at each iteration <span class="cite">[<span 
class="ptmb7t-">?</span>]</span>. Sequential Quadratic Programming is
an iterative method for nonlinear optimization, which is typically
used on problems in which the objective function and the
constraints are twice continuously differentiable <span class="cite">[<span 
class="ptmb7t-">?</span>]</span>. The active
set method, in general, is faster than the two aforementioned
algorithms; however it takes large steps, as it is suited for
large scale problem, which may lead inaccurate minima       determination <span class="cite">[<span 
class="ptmb7t-">?</span>]</span>, and thus will herein escape the scope
                                                  of this paper. In use, the user&#8217;s discretion determines the
                                                  algorithm used by passing its string designation to the function,
                                                  <span class="lstinline"></span><span 
class="pcrb7t-x-x-80">function</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">[</span><span 
class="pcrr7t-x-x-80">aopt</span><span 
class="pcrr7t-x-x-80">,</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">fval</span><span 
class="pcrr7t-x-x-80">]</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">=</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">Optimize</span><span 
class="pcrr7t-x-x-80">(</span><span 
class="pcrr7t-x-x-80">obj</span><span 
class="pcrr7t-x-x-80">,</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">a0</span><span 
class="pcrr7t-x-x-80">,</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">alg</span><span 
class="pcrr7t-x-x-80">)</span> of Listing
                                                  <a 
href="#x1-23001r4">4<!--tex4ht:ref: Heat_Exchanger --></a>.
                                                  </p><!--l. 115--><p class="noindent" ><span 
class="ptmb7t-">4.</span>
                                                  </p>
                                                     <h3 class="sectionHead"><span class="titlemark">4    </span> <a 
 id="x1-140004"></a>Implementation</h3>
                                                  <!--l. 116--><p class="noindent" >In the effort to enable the modular implementation of the methods
                                                  and formulation described in previous sections, a Heat Exchanger
                                                  class is constructed in MATLAB, as shown in Listing <a 
href="#x1-23001r4">4<!--tex4ht:ref: Heat_Exchanger --></a>, allowing
                                                  one to instantiate an object of the heat exchanger class as such:
                                                  </p><!--l. 117-->
                                                  <a 
 id="x1-14001r1"></a>
                                                  <a 
 id="x1-14002"></a>
                                                  <br />
                                                      <div class="caption" 
><span class="id">Listing&#x00A0;1:
                                                      </span><span  
class="content">Instantiation</span></div><!--tex4ht:label?: x1-14001r4 --><div class="lstlisting" id="listing-1"><span class="label"><a 
 id="x1-14003r1"></a></span><span 
class="pcrr7t-x-x-80">HE</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">=</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">Heat_Exchanger</span><span 
class="pcrr7t-x-x-80">(...</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><br /><span class="label"><a 
 id="x1-14004r2"></a></span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">0.05,</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">...</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">%</span><span 
class="pcrro7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">Horizontal</span><span 
class="pcrro7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">width</span><span 
class="pcrro7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">(</span><span 
class="pcrro7t-x-x-80">m</span><span 
class="pcrro7t-x-x-80">)</span><span 
class="pcrro7t-x-x-80">.</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><br /><span class="label"><a 
 id="x1-14005r3"></a></span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">0.01,</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">...</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">%</span><span 
class="pcrro7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">Minimum</span><span 
class="pcrro7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">thickness</span><span 
class="pcrro7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">(</span><span 
class="pcrro7t-x-x-80">m</span><span 
class="pcrro7t-x-x-80">)</span><span 
class="pcrro7t-x-x-80">.</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><br /><span class="label"><a 
 id="x1-14006r4"></a></span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">0.05,</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">...</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">%</span><span 
class="pcrro7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">Maximum</span><span 
class="pcrro7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">thickness</span><span 
class="pcrro7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">(</span><span 
class="pcrro7t-x-x-80">m</span><span 
class="pcrro7t-x-x-80">)</span><span 
class="pcrro7t-x-x-80">.</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><br /><span class="label"><a 
 id="x1-14007r5"></a></span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">20,</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">...</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">%</span><span 
class="pcrro7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">Thermal</span><span 
class="pcrro7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">conductivity</span><span 
class="pcrro7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">(</span><span 
class="pcrro7t-x-x-80">W</span><span 
class="pcrro7t-x-x-80">/</span><span 
class="pcrro7t-x-x-80">mK</span><span 
class="pcrro7t-x-x-80">)</span><span 
class="pcrro7t-x-x-80">.</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><br /><span class="label"><a 
 id="x1-14008r6"></a></span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">90</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">+</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">273.15,</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">...</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">%</span><span 
class="pcrro7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">Bottom</span><span 
class="pcrro7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">surface</span><span 
class="pcrro7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">temp</span><span 
class="pcrro7t-x-x-80">.</span><span 
class="pcrro7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">(</span><span 
class="pcrro7t-x-x-80">K</span><span 
class="pcrro7t-x-x-80">)</span><span 
class="pcrro7t-x-x-80">.</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><br /><span class="label"><a 
 id="x1-14009r7"></a></span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">20</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">+</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">273.15,</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">...</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">%</span><span 
class="pcrro7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">Top</span><span 
class="pcrro7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">surface</span><span 
class="pcrro7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">temp</span><span 
class="pcrro7t-x-x-80">.</span><span 
class="pcrro7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">(</span><span 
class="pcrro7t-x-x-80">K</span><span 
class="pcrro7t-x-x-80">)</span><span 
class="pcrro7t-x-x-80">.</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><br /><span class="label"><a 
 id="x1-14010r8"></a></span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">100,</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">...</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">%</span><span 
class="pcrro7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">#</span><span 
class="pcrro7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">of</span><span 
class="pcrro7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">horizontal</span><span 
class="pcrro7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">elements</span><span 
class="pcrro7t-x-x-80">.</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><br /><span class="label"><a 
 id="x1-14011r9"></a></span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">100</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">...</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">%</span><span 
class="pcrro7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">#</span><span 
class="pcrro7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">of</span><span 
class="pcrro7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">vertical</span><span 
class="pcrro7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">elements</span><span 
class="pcrro7t-x-x-80">.</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><br /><span class="label"><a 
 id="x1-14012r10"></a></span><span 
class="pcrr7t-x-x-80">)</span><span 
class="pcrr7t-x-x-80">;</span>
                                                     </div>
                                                  <!--l. 130--><p class="noindent" ><span 
class="ptmb7t-">4.1.</span>
                                                  </p>
                                                     <h4 class="subsectionHead"><span class="titlemark">4.1    </span> <a 
 id="x1-150004.1"></a>Dynamic Coefficient Creation</h4>
                                                  <!--l. 131--><p class="noindent" >Once the heat exchanger object has been instantiated, one can test
                                                  the dynamic scaling of the top surface mesh generation function,
                                                  <span class="lstinline"></span><span 
class="pcrb7t-x-x-80">function</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">ts</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">=</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">Surface</span><span 
class="pcrr7t-x-x-80">(</span><span 
class="pcrr7t-x-x-80">obj</span><span 
class="pcrr7t-x-x-80">,</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">a</span><span 
class="pcrr7t-x-x-80">)</span>, by executing the following:
                                                  </p><!--l. 132-->
                                                  <a 
 id="x1-15001r2"></a>
                                                  <a 
 id="x1-15002"></a>
                                                  <br />
                                                      <div class="caption" 
><span class="id">Listing&#x00A0;2:
                                                      </span><span  
class="content">Dynamics
                                                      Coefficient
                                                      Creation</span></div><!--tex4ht:label?: x1-15001r4 --><div class="lstlisting" id="listing-2"><span class="label"><a 
 id="x1-15003r1"></a></span><span 
class="pcrb7t-x-x-80">figure</span><span 
class="pcrr7t-x-x-80">;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15004r2"></a></span><span 
class="pcrb7t-x-x-80">hold</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">on</span><span 
class="pcrr7t-x-x-80">;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15005r3"></a></span><span 
class="pcrb7t-x-x-80">for</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">n</span><span 
class="pcrr7t-x-x-80">=1:10</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15006r4"></a></span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">a</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">=</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">ones</span><span 
class="pcrr7t-x-x-80">(</span><span 
class="pcrr7t-x-x-80">n</span><span 
class="pcrr7t-x-x-80">)</span><span 
class="pcrr7t-x-x-80">.';</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15007r5"></a></span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">y</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">=</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">HE</span><span 
class="pcrr7t-x-x-80">.</span><span 
class="pcrr7t-x-x-80">Surface</span><span 
class="pcrr7t-x-x-80">(</span><span 
class="pcrr7t-x-x-80">a</span><span 
class="pcrr7t-x-x-80">)</span><span 
class="pcrr7t-x-x-80">;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15008r6"></a></span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">x</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">=</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrb7t-x-x-80">linspace</span><span 
class="pcrr7t-x-x-80">(0,</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">HE</span><span 
class="pcrr7t-x-x-80">.</span><span 
class="pcrr7t-x-x-80">Lx</span><span 
class="pcrr7t-x-x-80">,</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">HE</span><span 
class="pcrr7t-x-x-80">.</span><span 
class="pcrr7t-x-x-80">Nx</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">+</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">1)</span><span 
class="pcrr7t-x-x-80">;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15009r7"></a></span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrb7t-x-x-80">plot</span><span 
class="pcrr7t-x-x-80">(</span><span 
class="pcrr7t-x-x-80">x</span><span 
class="pcrr7t-x-x-80">,</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">y</span><span 
class="pcrr7t-x-x-80">)</span><span 
class="pcrr7t-x-x-80">;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15010r8"></a></span><span 
class="pcrb7t-x-x-80">end</span>
                                                     </div>
                                                  <!--l. 142--><p class="indent" >   from which, with some additional annotation, the plot in
                                                  Figure <a 
href="#x1-15011r1">1<!--tex4ht:ref: fig:dcc --></a> is generated. The user can specify a coefficient vector of
                                                  an arbitrary length, <span 
class="cmmi-10">N</span>, and the top surface mesh function&#8217;s sin
                                                  formulation will accommodate it. </p><hr class="figure" /><div class="figure" 
>

<a 
 id="x1-15011r1"></a><a 
 id="x1-19001r3"></a>

<!--l. 145--><p class="noindent" ><img 
src="TemplateICATT9x.png" alt="PIC" class="graphics" width="243.09818pt" height="249.85464pt"  /><!--tex4ht:graphics  
name="TemplateICATT9x.png" src="Pics/Dynamic_Coefficient_Creation.eps"  
-->
<br /> </p><div class="caption" 
><span class="id"><span 
class="ptmb7t-">Fig.</span><span 
class="ptmb7t-">&#x00A0;1</span>: </span><span  
class="content">Dynamic Coefficient Creation</span></div><!--tex4ht:label?: x1-15011r1 -->

   </div><hr class="endfigure" />
   <span 
class="ptmb7t-">4.2.</span>
   <h4 class="subsectionHead"><span class="titlemark">4.2    </span> <a 
 id="x1-160004.2"></a>Work Flow</h4>
<!--l. 151--><p class="noindent" >With the instantiated heat exchanger object, the user can
begin the optimization process by asserting an initial guess,
<span class="lstinline"></span><span 
class="pcrr7t-x-x-80">a0</span>. Then after, the initial guess is fed through the heat
exchanger&#8217;s class instance optimization method as follows,
<span class="lstinline"></span><span 
class="pcrr7t-x-x-80">[</span><span 
class="pcrr7t-x-x-80">aopt</span><span 
class="pcrr7t-x-x-80">,</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">fval</span><span 
class="pcrr7t-x-x-80">]</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">=</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">HE</span><span 
class="pcrr7t-x-x-80">.</span><span 
class="pcrr7t-x-x-80">Optimise</span><span 
class="pcrr7t-x-x-80">(</span><span 
class="pcrr7t-x-x-80">a0</span><span 
class="pcrr7t-x-x-80">,</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">alg</span><span 
class="pcrr7t-x-x-80">)</span>, where <span class="lstinline"></span><span 
class="pcrr7t-x-x-80">alg</span> is a string in
the list: <span class="lstinline"></span><span 
class="pcrr7t-x-x-80">[</span><span 
class="pcrr7t-x-x-80">'</span><span 
class="pcrr7t-x-x-80">interior</span><span 
class="pcrr7t-x-x-80">-</span><span 
class="pcrr7t-x-x-80">point</span><span 
class="pcrr7t-x-x-80">'</span><span 
class="pcrr7t-x-x-80">,</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">'</span><span 
class="pcrr7t-x-x-80">sqp</span><span 
class="pcrr7t-x-x-80">'</span><span 
class="pcrr7t-x-x-80">,</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">'</span><span 
class="pcrr7t-x-x-80">active</span><span 
class="pcrr7t-x-x-80">-</span><span 
class="pcrr7t-x-x-80">set</span><span 
class="pcrr7t-x-x-80">'</span><span 
class="pcrr7t-x-x-80">]</span>. Finally,
the user can visualize the resulting geometry simply by running
<span class="lstinline"></span><span 
class="pcrr7t-x-x-80">HE</span><span 
class="pcrr7t-x-x-80">.</span><span 
class="pcrr7t-x-x-80">Visualise</span><span 
class="pcrr7t-x-x-80">(</span><span 
class="pcrr7t-x-x-80">aopt</span><span 
class="pcrr7t-x-x-80">)</span>.
</p><!--l. 153--><p class="noindent" ><span 
class="ptmb7t-">5.</span>
</p>
   <h3 class="sectionHead"><span class="titlemark">5    </span> <a 
 id="x1-170005"></a>Results</h3>
<!--l. 154--><p class="noindent" >After instantiating an object of the heat exchanger class, as
shown in Listing <a 
href="#x1-14001r1">1<!--tex4ht:ref: instant --></a>, it is rather easy to begin the process of
optimization by asserting an initial guess of the optimal
coefficient vector.
</p><!--l. 156--><p class="noindent" ><span 
class="ptmb7t-">5.1.</span>
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.1    </span> <a 
 id="x1-180005.1"></a>Initial Findings</h4>
<!--l. 156--><p class="noindent" >It was found, through trial and error, that the chance of
convergence among all algorithms was maximized with an initial
coefficient vector guess such that the sin series oscillates about a
thickness of <span 
class="cmr-10">3</span><span 
class="cmmi-10">&#x00A0;cm</span>. Such as it is, the first term in all initial
guesses of the coefficient vector shall herein be asserted as
<span 
class="cmmi-10">a</span><sub><span 
class="cmr-7">1</span></sub> <span 
class="cmr-10">= 0</span><span 
class="cmmi-10">.</span><span 
class="cmr-10">03</span><span 
class="cmmi-10">&#x00A0;m</span>.
</p><!--l. 158--><p class="noindent" ><span 
class="ptmb7t-">5.2.</span>
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.2    </span> <a 
 id="x1-190005.2"></a>Interior-Point Optimizer</h4>
<!--l. 159--><p class="noindent" >Through practice it was found that through both mesh resolution
and coefficient vector length alteration, that the interior-point
optimizer (IPOPT) algorithm is rather finicky at lower mesh
resolutions, but it was indeed shown that convergence to a
performance of over 35% greater than the nominal flat plate flux
value was aided by resolution increases. For example, a
coefficient vector guess of length six and vertical and horizontal
resolutions of 200 nodes was optimized and visualized as follows:
</p><!--l. 160-->
<a 
 id="x1-19002"></a>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;3:
    </span><span  
class="content">Implementation</span></div><!--tex4ht:label?: x1-19001r5 --><div class="lstlisting" id="listing-3"><span class="label"><a 
 id="x1-19003r1"></a></span><span 
class="pcrro7t-x-x-80">%</span><span 
class="pcrro7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">Resolution</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><br /><span class="label"><a 
 id="x1-19004r2"></a></span><span 
class="pcrr7t-x-x-80">HE</span><span 
class="pcrr7t-x-x-80">.</span><span 
class="pcrr7t-x-x-80">Nx</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">=</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">200;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">HE</span><span 
class="pcrr7t-x-x-80">.</span><span 
class="pcrr7t-x-x-80">Ny</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">=</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">200;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><br /><span class="label"><a 
 id="x1-19005r3"></a></span><span 
class="pcrro7t-x-x-80">%</span><span 
class="pcrro7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">Coefficient</span><span 
class="pcrro7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">vector</span><span 
class="pcrro7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">guess</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><br /><span class="label"><a 
 id="x1-19006r4"></a></span><span 
class="pcrr7t-x-x-80">a0</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">=</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">[0.03;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">0.0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">0.0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">0.0;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">0.0]</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><br /><span class="label"><a 
 id="x1-19007r5"></a></span><span 
class="pcrro7t-x-x-80">%</span><span 
class="pcrro7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">Optimization</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><br /><span class="label"><a 
 id="x1-19008r6"></a></span><span 
class="pcrr7t-x-x-80">[</span><span 
class="pcrr7t-x-x-80">aopt</span><span 
class="pcrr7t-x-x-80">,</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">fval</span><span 
class="pcrr7t-x-x-80">]</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">=</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">HE</span><span 
class="pcrr7t-x-x-80">.</span><span 
class="pcrr7t-x-x-80">Optimise</span><span 
class="pcrr7t-x-x-80">(</span><span 
class="pcrr7t-x-x-80">a0</span><span 
class="pcrr7t-x-x-80">,</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">'</span><span 
class="pcrr7t-x-x-80">interior</span><span 
class="pcrr7t-x-x-80">-</span><span 
class="pcrr7t-x-x-80">point</span><span 
class="pcrr7t-x-x-80">'</span><span 
class="pcrr7t-x-x-80">)</span><span 
class="pcrr7t-x-x-80">;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><br /><span class="label"><a 
 id="x1-19009r7"></a></span><span 
class="pcrro7t-x-x-80">%</span><span 
class="pcrro7t-x-x-80">&#x00A0;</span><span 
class="pcrro7t-x-x-80">Visualization</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><br /><span class="label"><a 
 id="x1-19010r8"></a></span><span 
class="pcrr7t-x-x-80">HE</span><span 
class="pcrr7t-x-x-80">.</span><span 
class="pcrr7t-x-x-80">Visualise</span><span 
class="pcrr7t-x-x-80">(</span><span 
class="pcrr7t-x-x-80">aopt</span><span 
class="pcrr7t-x-x-80">)</span><span 
class="pcrr7t-x-x-80">;</span></div>
                                                  <!--l. 170--><p class="indent" >   leading to an optimal coefficient vector of
                                                  <span class="lstinline"></span><span 
class="pcrr7t-x-x-80">aopt</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">=</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">[0.0300;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">-0.0025;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">0.0044;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">0.0032;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">0.0146;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">-0.0049]</span>,
                                                  with a flux per unit length of <span 
class="cmr-10">9876</span><span 
class="cmmi-10">.</span><span 
class="cmr-10">19</span><span 
class="cmmi-10">&#x00A0;</span><img 
src="TemplateICATT10x.png" alt="Wm-"  class="frac" align="middle" />. This particular case is
                                                  shown in Figure <a 
href="#x1-19013r4">4<!--tex4ht:ref: fig:ipopt_5_200 --></a>. The geometries resulting from an initial
                                                  coefficient vector guess of length six, as show in in Figures <a 
href="#x1-19011r2">2<!--tex4ht:ref: fig:ipopt_6_100 --></a> and
                                                  <a 
href="#x1-19012r3">3<!--tex4ht:ref: fig:ipopt_6_200 --></a>, offered even higher gains in performance, garnering a
                                                  flux per unit length of <span 
class="cmr-10">10442</span><span 
class="cmmi-10">.</span><span 
class="cmr-10">4008</span><span 
class="cmmi-10">&#x00A0;</span><img 
src="TemplateICATT11x.png" alt="Wm-"  class="frac" align="middle" /> and <span 
class="cmr-10">10518</span><span 
class="cmmi-10">.</span><span 
class="cmr-10">4232</span><span 
class="cmmi-10">&#x00A0;</span><img 
src="TemplateICATT12x.png" alt="Wm-"  class="frac" align="middle" />
                                                  respectively. These results are summarized in Table <a 
href="#x1-22001r1">1<!--tex4ht:ref: tab:ipopt --></a>. It can
                                                  be seen that accuracy is indeed confirmed through mesh
                                                  refinement.
                                                  </p>
                                                     <hr class="figure" /><div class="figure" 
>

<a 
 id="x1-19011r2"></a>

<!--l. 174--><p class="noindent" ><img 
src="TemplateICATT13x.png" alt="PIC" class="graphics" width="243.09818pt" height="245.1184pt"  /><!--tex4ht:graphics  
name="TemplateICATT13x.png" src="Pics/ipopt_6_100.eps"  
-->
<br /> </p><div class="caption" 
><span class="id"><span 
class="ptmb7t-">Fig.</span><span 
class="ptmb7t-">&#x00A0;2</span>: </span><span  
class="content">IPOPT with 6 coefficients and 100 node resolution</span></div><!--tex4ht:label?: x1-19011r2 -->

   </div><hr class="endfigure" />
   <hr class="figure" /><div class="figure" 
>

<a 
 id="x1-19012r3"></a>

<!--l. 181--><p class="noindent" ><img 
src="TemplateICATT14x.png" alt="PIC" class="graphics" width="243.09818pt" height="245.1184pt"  /><!--tex4ht:graphics  
name="TemplateICATT14x.png" src="Pics/ipopt_6_200.eps"  
-->
<br /> </p><div class="caption" 
><span class="id"><span 
class="ptmb7t-">Fig.</span><span 
class="ptmb7t-">&#x00A0;3</span>: </span><span  
class="content">IPOPT with 6 coefficients and 200 node resolution</span></div><!--tex4ht:label?: x1-19012r3 -->

   </div><hr class="endfigure" />
   <hr class="figure" /><div class="figure" 
>

<a 
 id="x1-19013r4"></a>

<!--l. 188--><p class="noindent" ><img 
src="TemplateICATT15x.png" alt="PIC" class="graphics" width="243.09818pt" height="245.1184pt"  /><!--tex4ht:graphics  
name="TemplateICATT15x.png" src="Pics/ipopt_5_200.eps"  
-->
<br /> </p><div class="caption" 
><span class="id"><span 
class="ptmb7t-">Fig.</span><span 
class="ptmb7t-">&#x00A0;4</span>: </span><span  
class="content">IPOPT with 5 coefficients and 200 node resolution</span></div><!--tex4ht:label?: x1-19013r4 -->

   </div><hr class="endfigure" />
   <span 
class="ptmb7t-">5.3.</span>
   <h4 class="subsectionHead"><span class="titlemark">5.3    </span> <a 
 id="x1-200005.3"></a>Sequential Quadratic Programming</h4>
<!--l. 194--><p class="noindent" >The method of sequential quadratic programming, otherwise
known as SQP, is undoubtedly very powerful. However, in the
case of the heat exchanger&#8217;s top surface shape optimization, it
proved to be exceedingly painstaking and slow. For nearly
all of the cases that the interior point optimizer faced with
acceptable results, the SQP solver tended to get stuck in local
infeasible minima, while its step size became increasingly
smaller until termination. However, one strike of feasibility and
incredible results came with six coefficients and 200 vertical
and horizontal nodes, generating an incredible heat flux per
unit length of <span 
class="cmr-10">12682</span><span 
class="cmmi-10">.</span><span 
class="cmr-10">4002</span><span 
class="cmmi-10">&#x00A0;</span><img 
src="TemplateICATT16x.png" alt="Wm"  class="frac" align="middle" />, with a coefficient vector of
<span class="lstinline"></span><span 
class="pcrr7t-x-x-80">aopt</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">=</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">[0.0300;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">-0.0019;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">-0.0015;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">0.0008;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">-0.0190;</span><span 
class="pcrr7t-x-x-80">&#x00A0;</span><span 
class="pcrr7t-x-x-80">0.0001]</span>.
This is an 81% improvement over the nominal heat flux value of a
flat heat exchanger with equivalent dimesions. The resulting
geometry can be seen in Figure <a 
href="#x1-20001r5">5<!--tex4ht:ref: fig:sqp_6_200 --></a>.
</p>
   <hr class="figure" /><div class="figure" 
>

<a 
 id="x1-20001r5"></a>

<!--l. 198--><p class="noindent" ><img 
src="TemplateICATT17x.png" alt="PIC" class="graphics" width="243.09818pt" height="245.1184pt"  /><!--tex4ht:graphics  
name="TemplateICATT17x.png" src="Pics/sqp_6_200.eps"  
-->
<br /> </p><div class="caption" 
><span class="id"><span 
class="ptmb7t-">Fig.</span><span 
class="ptmb7t-">&#x00A0;5</span>: </span><span  
class="content">SQP with 6 coefficients and 200 node resolution</span></div><!--tex4ht:label?: x1-20001r5 -->

   </div><hr class="endfigure" />
<span 
class="ptmb7t-">6.</span>
   <h3 class="sectionHead"><span class="titlemark">6    </span> <a 
 id="x1-210006"></a>Conclusions</h3>
<!--l. 204--><p class="noindent" >It has been shown that improvements of over 35% of the nominal
value of heat flux from a flat heat exchanger can be made. The
scalability of the sin series, used to model the heat exchanger&#8217;s top
surface was quite conducive in enabling the testing various
amounts of coefficients. It has been shown that, in regards to
a sin series formulation, a greater amount of coefficients
tends to garner a higher value of heat flux per unit length, in
this two dimensional case. Furthermore, it has been shown
that increasing the resolution of the optimization process
leads to a marginal gain in heat flux performance, that rather
serves as an indication of accuracy, as shown in the transition
between 100 to 200 nodes for the six coefficient IPOPT model.
It can be seen that, although it is indicated that increasing
the size of the input parameters leads to a gain in heat flux
performance, it was also quite obvious that there was a loss in
computational performance. With increasing resolution of the
optimization, one is limited by their computer&#8217;s free random
access memory, and with increasing coefficient vector size, one
is limited by time, as the computations become evermore
prolonged.

<span 
class="ptmb7t-">7.</span>
</p>
   <h3 class="sectionHead"><span class="titlemark">7    </span> <a 
 id="x1-220007"></a>Tables</h3>
   <div class="table">

<!--l. 215--><p class="indent" >   <a 
 id="x1-22001r1"></a><a 
 id="x1-23001r4"></a></p><hr class="float" /><div class="float" 
>

 <div class="caption" 
><span class="id"><span 
class="ptmb7t-">Table 1</span>: </span><span  
class="content">Interior Point Optimizer Performance</span></div><!--tex4ht:label?: x1-22001r1 -->
<div class="tabular"> <table id="TBL-2" class="tabular" 
cellspacing="0" cellpadding="0" rules="groups" 
><colgroup id="TBL-2-1g"><col 
id="TBL-2-1" /></colgroup><colgroup id="TBL-2-2g"><col 
id="TBL-2-2" /></colgroup><colgroup id="TBL-2-3g"><col 
id="TBL-2-3" /></colgroup><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-1-1"  
class="td11">                 </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-1-2"  
class="td11">Heat Flux Per Unit Length (W/m)</td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-1-3"  
class="td11">Coefficient Vector                                                     </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-2-1"  
class="td11">100 Nodes, 5 Coefficients</td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-2-2"  
class="td11">N/A                                               </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-2-3"  
class="td11">N/A                                                                           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-3-1"  
class="td11">100 Nodes, 6 Coefficients</td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-3-2"  
class="td11">10442.4008                                   </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-3-3"  
class="td11">[0.0300; -0.0025; 0.0044; 0.0032; 0.0145; -0.0048]</td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-4-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-4-1"  
class="td11">200 Nodes, 5 Coefficients</td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-4-2"  
class="td11">9876.19                                         </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-4-3"  
class="td11">[0.0300; -0.0021; 0.0024; -0.0187; -0.0025]            </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-5-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-5-1"  
class="td11">200 Nodes, 6 Coefficients</td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-5-2"  
class="td11">10518.4232                                   </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-5-3"  
class="td11">[0.0300; -0.0025; 0.0044; 0.0032; 0.0146; -0.0049]</td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-6-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-6-1"  
class="td11">                 </td></tr></table></div>

   </div><hr class="endfloat" />
   </div>
<span 
class="ptmb7t-">8.</span>
   <h3 class="sectionHead"><span class="titlemark">8    </span> <a 
 id="x1-230008"></a>Source Code</h3>
   <!--l. 230--><div class="lstinputlisting">
<a 
 id="x1-23002"></a>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;4:
    </span><span  
class="content">Heat
    Exchanger
    Class
    </span></div><!--tex4ht:label?: x1-23001r8 --><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23003r1"></a>1</span><span 
class="pcrr7t-">classdef</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">Heat_Exchanger</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23004r2"></a>2</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">properties</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23005r3"></a>3</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">Lx</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">%</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">Horizontal</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">width</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">(</span><span 
class="pcrro7t-">float</span><span 
class="pcrro7t-">)</span><span 
class="pcrro7t-">(</span><span 
class="pcrro7t-">metres</span><span 
class="pcrro7t-">)</span><span 
class="pcrro7t-">.</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23006r4"></a>4</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">Lymin</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">Lymax</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrro7t-">%</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">Minimum</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">and</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">maximum</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">vertical</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">thicknesses</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">(</span><span 
class="pcrro7t-">float</span><span 
class="pcrro7t-">)</span><span 
class="pcrro7t-">(</span><span 
class="pcrro7t-">metres</span><span 
class="pcrro7t-">)</span><span 
class="pcrro7t-">.</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23007r5"></a>5</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">k</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">%</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">Thermal</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">conductivity</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">(</span><span 
class="pcrro7t-">float</span><span 
class="pcrro7t-">)</span><span 
class="pcrro7t-">(</span><span 
class="pcrro7t-">Watts</span><span 
class="pcrro7t-">/</span><span 
class="pcrro7t-">metres</span><span 
class="pcrro7t-">/</span><span 
class="pcrro7t-">Kelvin</span><span 
class="pcrro7t-">)</span><span 
class="pcrro7t-">.</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23008r6"></a>6</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">T1</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">T2</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">%</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">Top</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">and</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">bottom</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">environmental</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">temperatures</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">(</span><span 
class="pcrro7t-">float</span><span 
class="pcrro7t-">)</span><span 
class="pcrro7t-">(</span><span 
class="pcrro7t-">Kelvin</span><span 
class="pcrro7t-">)</span><span 
class="pcrro7t-">.</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23009r7"></a>7</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">Nx</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">Ny</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">%</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">Number</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">of</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">elements</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">along</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">x</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">and</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">y</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">directions</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">(</span><span 
class="pcrro7t-">integer</span><span 
class="pcrro7t-">)</span><span 
class="pcrro7t-">.</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23010r8"></a>8</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">end</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23011r9"></a>9</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">methods</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23012r10"></a>10</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">function</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">obj</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">Heat_Exchanger</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">Lx</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">Lymin</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">Lymax</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">k</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">T1</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">T2</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">Nx</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">Ny</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23013r11"></a>11</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">%</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">Constructs</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">Heat</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">Exchanger</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">class</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">instance</span><span 
class="pcrro7t-">.</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23014r12"></a>12</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">obj</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">Lx</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">Lx</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23015r13"></a>13</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">obj</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">Lymin</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">Lymin</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23016r14"></a>14</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">obj</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">Lymax</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">Lymax</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23017r15"></a>15</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">obj</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">k</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">k</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23018r16"></a>16</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">obj</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">T1</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">T1</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23019r17"></a>17</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">obj</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">T2</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">T2</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23020r18"></a>18</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">obj</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">Nx</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">Nx</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23021r19"></a>19</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">obj</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">Ny</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">Ny</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23022r20"></a>20</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">end</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23023r21"></a>21</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">function</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">ts</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">Surface</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">obj</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">a</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23024r22"></a>22</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">%</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">Generates</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">the</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">form</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">of</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">the</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">top</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">surface</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">as</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">a</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">function</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">of</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">(</span><span 
class="pcrro7t-">a</span><span 
class="pcrro7t-">,</span><span 
class="pcrro7t-">x</span><span 
class="pcrro7t-">)</span><span 
class="pcrro7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23025r23"></a>23</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">%</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">according</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">to</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">the</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">specified</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">number</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">of</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">coefficients</span><span 
class="pcrro7t-">.</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23026r24"></a>24</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">%</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">First</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">necessary</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">coefficient</span><span 
class="pcrro7t-">.</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23027r25"></a>25</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">eqn</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">@</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">x</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">a</span><span 
class="pcrr7t-">(1)</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23028r26"></a>26</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">%</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">Summation</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">of</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">the</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">sin</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">series</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">according</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">to</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">length</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">of</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">vector</span><span 
class="pcrro7t-">.</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23029r27"></a>27</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">for</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">n</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">2:</span><span 
class="pcrb7t-">length</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">a</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23030r28"></a>28</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">eqn</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">@</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">x</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">eqn</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">x</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">+</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">a</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">n</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrb7t-">sin</span><span 
class="pcrr7t-">((2&#x22C6;</span><span 
class="pcrb7t-">pi</span><span 
class="pcrr7t-">&#x22C6;(</span><span 
class="pcrr7t-">n</span><span 
class="pcrr7t-">-1)</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">x</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">/</span><span 
class="pcrr7t-">obj</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">Lx</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23031r29"></a>29</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">end</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23032r30"></a>30</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">ts</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">eqn</span><span 
class="pcrr7t-">(</span><span 
class="pcrb7t-">linspace</span><span 
class="pcrr7t-">(0,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">obj</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">Lx</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">obj</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">Nx</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">+</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">1)</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">.';</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23033r31"></a>31</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">end</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23034r32"></a>32</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">function</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">f</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">Neg_Flux</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">obj</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">a</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23035r33"></a>33</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">%</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">Calculates</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">the</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">negative</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">flux</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">of</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">the</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">given</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">geometry</span><span 
class="pcrro7t-">.</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23036r34"></a>34</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">%</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">Generate</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">top</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">surface</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">mesh</span><span 
class="pcrro7t-">.</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23037r35"></a>35</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">h</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">obj</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">Surface</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">a</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23038r36"></a>36</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">%</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">Calculate</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">the</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">flux</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">per</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">unit</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">length</span><span 
class="pcrro7t-">.</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23039r37"></a>37</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">flux</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">CalcFlux</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">obj</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">Lx</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">h</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">obj</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">Nx</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">obj</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">Ny</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">obj</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">k</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">obj</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">T2</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">obj</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">T1</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23040r38"></a>38</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">%</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">Negative</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">sign</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">to</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">convert</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">for</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">minimization</span><span 
class="pcrro7t-">.</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23041r39"></a>39</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">f</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">-</span><span 
class="pcrr7t-">flux</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23042r40"></a>40</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">end</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23043r41"></a>41</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">function</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">[</span><span 
class="pcrr7t-">c</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">ceq</span><span 
class="pcrr7t-">]</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">Thickness_Limit</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">obj</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">a</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23044r42"></a>42</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">%</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">Mesh</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">of</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">top</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">surface</span><span 
class="pcrro7t-">.</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23045r43"></a>43</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">ts</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">obj</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">Surface</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">a</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23046r44"></a>44</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">%</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">Maximum</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">point</span><span 
class="pcrro7t-">.</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23047r45"></a>45</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">tmax</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">max</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">ts</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23048r46"></a>46</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">%</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">Minimum</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">point</span><span 
class="pcrro7t-">.</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23049r47"></a>47</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">tmin</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">min</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">ts</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23050r48"></a>48</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">%</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">Constraint</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">vector</span><span 
class="pcrro7t-">.</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23051r49"></a>49</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">c</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">[</span><span 
class="pcrr7t-">tmax</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">-</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">obj</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">Lymax</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">-</span><span 
class="pcrr7t-">tmin</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">+</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">obj</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">Lymin</span><span 
class="pcrr7t-">];</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23052r50"></a>50</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">ceq</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">[];</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23053r51"></a>51</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">end</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23054r52"></a>52</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">function</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">[</span><span 
class="pcrr7t-">aopt</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">fval</span><span 
class="pcrr7t-">]</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">Optimise</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">obj</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">a0</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">alg</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23055r53"></a>53</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">%</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">Specify</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">the</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">objective</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">function</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">to</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">be</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">minimized</span><span 
class="pcrro7t-">.</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23056r54"></a>54</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">fun</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">@obj</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">Neg_Flux</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23057r55"></a>55</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">%</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">Specify</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">the</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">nonlinear</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">inequality</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">constraints</span><span 
class="pcrro7t-">.</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23058r56"></a>56</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">nonlcon</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">@obj</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">Thickness_Limit</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23059r57"></a>57</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">%</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">Ignore</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">other</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">specifications</span><span 
class="pcrro7t-">.</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23060r58"></a>58</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">A</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">[];</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">b</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">[];</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">Aeq</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">[];</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">beq</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">[];</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">lb</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">[];</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">ub</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">[];</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23061r59"></a>59</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">%</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">Specify</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">optimization</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">options</span><span 
class="pcrro7t-">.</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23062r60"></a>60</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">options</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">optimoptions</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">...</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23063r61"></a>61</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">fmincon</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">...</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrro7t-">%</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">The</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">optimisation</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">algorithm</span><span 
class="pcrro7t-">.</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23064r62"></a>62</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">Display</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">iter</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">...</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrro7t-">%</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">Display</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">the</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">optimisation</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">output</span><span 
class="pcrro7t-">.</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23065r63"></a>63</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">UseParallel</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">true</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">...</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrro7t-">%</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">Use</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">multiple</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">CPUs</span><span 
class="pcrro7t-">.</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23066r64"></a>64</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">Algorithm</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">alg</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">...</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrro7t-">%</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">The</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">specified</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">algorithm</span><span 
class="pcrro7t-">.</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23067r65"></a>65</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">MaxFunctionEvaluations</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">5000,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">...</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrro7t-">%</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">Many</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">evaluations</span><span 
class="pcrro7t-">...</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23068r66"></a>66</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">MaxIterations</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">5000</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">...</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrro7t-">%</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">Many</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">iterations</span><span 
class="pcrro7t-">...</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23069r67"></a>67</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23070r68"></a>68</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">[</span><span 
class="pcrr7t-">aopt</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">fval</span><span 
class="pcrr7t-">]</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">fmincon</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">fun</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">a0</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">A</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">b</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">Aeq</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">beq</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">lb</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">ub</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">nonlcon</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">options</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23071r69"></a>69</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">end</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23072r70"></a>70</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">function</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">Visualise</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">obj</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">aopt</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23073r71"></a>71</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">ts</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">obj</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">Surface</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">aopt</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23074r72"></a>72</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">bs</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">zeros</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">obj</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">Nx</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">+</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">1)</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23075r73"></a>73</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">x</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">linspace</span><span 
class="pcrr7t-">(0,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">obj</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">Lx</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">obj</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">Nx</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">+</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">1)</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23076r74"></a>74</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">area</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">x</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">ts</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23077r75"></a>75</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">tstr</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">Heat</span><span 
class="pcrr7t-">&#x2423;</span><span 
class="pcrr7t-">Exchanger</span><span 
class="pcrr7t-">&#x2423;</span><span 
class="pcrr7t-">Geometry</span><span 
class="pcrr7t-">&#x2423;</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">$$Flux</span><span 
class="pcrr7t-">&#x2423;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x2423;</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23078r76"></a>76</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">tstr</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">strcat</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">tstr</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">num2str</span><span 
class="pcrr7t-">(-</span><span 
class="pcrr7t-">obj</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">Neg_Flux</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">aopt</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">~\</span><span 
class="pcrr7t-">frac</span><span 
class="pcrr7t-">{</span><span 
class="pcrr7t-">W</span><span 
class="pcrr7t-">}{</span><span 
class="pcrr7t-">m</span><span 
class="pcrr7t-">}</span><span 
class="pcrr7t-">$$</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23079r77"></a>77</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">title</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">tstr</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">Interpreter</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">latex</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23080r78"></a>78</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">xlabel</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">Width</span><span 
class="pcrr7t-">&#x2423;</span><span 
class="pcrr7t-">$$L_x$$</span><span 
class="pcrr7t-">&#x2423;</span><span 
class="pcrr7t-">[</span><span 
class="pcrr7t-">metres</span><span 
class="pcrr7t-">]</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">Interpreter</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">latex</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23081r79"></a>79</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">ystr</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">Thickness</span><span 
class="pcrr7t-">&#x2423;</span><span 
class="pcrr7t-">$$L_y$$</span><span 
class="pcrr7t-">&#x2423;</span><span 
class="pcrr7t-">[</span><span 
class="pcrr7t-">metres</span><span 
class="pcrr7t-">]</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23082r80"></a>80</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">ystr</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">strcat</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">ystr</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">$$</span><span 
class="pcrr7t-">~\</span><span 
class="pcrr7t-">mathbf</span><span 
class="pcrr7t-">{</span><span 
class="pcrr7t-">a</span><span 
class="pcrr7t-">}</span><span 
class="pcrr7t-">&#x2423;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x2423;</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">mat2str</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">aopt</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">$$</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23083r81"></a>81</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">ylabel</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">ystr</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">Interpreter</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">latex</span><span 
class="pcrr7t-">'</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23084r82"></a>82</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">end</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23085r83"></a>83</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">end</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23086r84"></a>84</span><span 
class="pcrb7t-">end</span>
   </div>
    
</body></html> 



